function [dety, IY] = invert_Y(Y0)
    Y = zeros(3, 3, 2);
    Y(:, :, 1) = Y0(:, 1:3);
    Y(:, :, 2) = Y0(:, 4:6);
    
    dety = zeros(2,1);
    dety(1) = det(Y(:, :, 1));
    Yc = [Y(1:2, :, 1); Y(3, :, 2)];    
    dety(2) = det(Yc);
    
    IYT = zeros(3, 3, 2);
    IYT(3, 1, 1) = det(Y(1:2, 2:3));
    IYT(3, 2, 1) = -det(Y(1:2, [1 3]));
    IYT(3, 3, 1) = det(Y(1:2, [1 2]));
    IYT(1, 1, 1) = det(Y(2:3, 2:3, 1));
    IYT(1, 1, 2) = det(Yc(2:3, 2:3));
    IYT(1, 2, 1) = -det(Y(2:3, [1 3], 1));
    IYT(1, 2, 2) = -det(Yc(2:3, [1 3]));
    IYT(1, 3, 1) = det(Y(2:3, [1 2], 1));
    IYT(1, 3, 2) = det(Yc(2:3, [1 2]));
    IYT(2, 1, 1) = -det(Y([1 3], 2:3, 1));
    IYT(2, 1, 2) = -det(Yc([1 3], 2:3));
    IYT(2, 2, 1) = det(Y([1 3], [1 3], 1));
    IYT(2, 2, 2) = det(Yc([1 3], [1 3]));
    IYT(2, 3, 1) = -det(Y([1 3], [1 2], 1));
    IYT(2, 3, 2) = -det(Yc([1 3], [1 2]));  
    IY(:, :, 1) = IYT(:, :, 1)';
    IY(:, :, 2) = IYT(:, :, 2)';
end